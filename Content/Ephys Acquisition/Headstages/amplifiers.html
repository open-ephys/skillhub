
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Amplifiers &#8212; SkillHub 0.0.0 documentation</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../../../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../../../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" href="../../../_static/theme_overrides.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/sphinx_tabs/tabs.css" type="text/css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
    <script src="../../../_static/jquery.js"></script>
    <script src="../../../_static/underscore.js"></script>
    <script src="../../../_static/doctools.js"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="Ground and Reference Pins" href="groundvsreference.html" />
    <link rel="prev" title="Headstages" href="index.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
    
    <div class="container-fluid" id="banner"></div>

    
    <nav class="navbar navbar-light navbar-expand-lg bg-light fixed-top bd-navbar" id="navbar-main"><div class="container-xl">

  <div id="navbar-start">
    
    

<a class="navbar-brand" href="../../../index.html">
  <img src="../../../_static/oe_logo_name.svg" class="logo" alt="logo">
</a>


    
  </div>

  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-collapsible" aria-controls="navbar-collapsible" aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
  </button>

  
  <div id="navbar-collapsible" class="col-lg-9 collapse navbar-collapse">
    <div id="navbar-center" class="mr-auto">
      
      <div class="navbar-center-item">
        <ul id="navbar-main-elements" class="navbar-nav">
    <li class="toctree-l1 current active nav-item">
 <a class="reference internal nav-link" href="../../index.html">
  All Topics
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../../../Tutorials/index.html">
  Tutorials
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../../../Contact/disclaimer_terms_conditions.html">
  Terms and Conditions
 </a>
</li>

    
</ul>
      </div>
      
    </div>

    <div id="navbar-end">
      
      <div class="navbar-end-item">
        <ul id="navbar-icon-links" class="navbar-nav" aria-label="Icon Links">
        <li class="nav-item">
          <a class="nav-link" href="https://github.com/open-ephys/skillhub" rel="noopener" target="_blank" title="GitHub"><span><i class="fab fa-github-square"></i></span>
            <label class="sr-only">GitHub</label></a>
        </li>
      </ul>
      </div>
      
    </div>
  </div>
</div>
    </nav>
    

    <div class="container-xl">
      <div class="row">
          
            
            <!-- Only show if we have sidebars configured, else just a small margin  -->
            <div class="col-12 col-md-3 bd-sidebar">
              <div class="sidebar-start-items"><form class="bd-search d-flex align-items-center" action="../../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  <div class="bd-toc-item active">
    <ul class="current nav bd-sidenav">
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="../index.html">
   Electrophysiology Acquisition
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="../Acquisition%20Board/index.html">
     Acquisition Boards
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Computer/index.html">
     Software
    </a>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../Electrodes/index.html">
     Electrodes
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
    <label for="toctree-checkbox-2">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../Electrodes/electrodetypes.html">
       Types of Electrodes
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../Electrodes/howelectrodeswork.html">
       How do electrodes detect extracellular signals?
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../Electrodes/platingelectrodes.html">
       Plating Electrodes
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../Electrodes/tetrodeintro.html">
       Tetrodes
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 current active has-children">
    <a class="reference internal" href="index.html">
     Headstages
    </a>
    <input checked="" class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
    <label for="toctree-checkbox-3">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul class="current">
     <li class="toctree-l3 current active">
      <a class="current reference internal" href="#">
       Amplifiers
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="groundvsreference.html">
       Ground and Reference Pins
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="intanpinout.html">
       Intan Pinout
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../IO/index.html">
     Inputs/Outputs
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Cabling/index.html">
     Connectors and Cables
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Troubleshooting/index.html">
     Saturation
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../Electronics/index.html">
   Electronics
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
  <label for="toctree-checkbox-4">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../Electronics/electronicsrefresher.html">
     Electronics Refresher
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../Electronics/impedance.html">
     Impedance
    </a>
   </li>
  </ul>
 </li>
</ul>

  </div>
</nav>
              </div>
              <div class="sidebar-end-items">
              </div>
            </div>
            
          

          
          <div class="d-none d-xl-block col-xl-2 bd-toc">
            
              
              <div class="toc-item">
                
<div class="tocsection onthispage mt-5 pt-1 pb-3">
    <i class="fas fa-list"></i> On this page
</div>

<nav id="bd-toc-nav">
    <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#amplifier-properties">
   Amplifier properties
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#amplifiers-have-high-input-impedance">
     Amplifiers have high input impedance
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#amplifiers-have-low-output-impedance">
     Amplifiers have low output impedance
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#amplifiers-in-the-headstage-prevent-current-being-drawn">
   Amplifiers in the headstage prevent current being drawn
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#differential-amplifiers-remove-common-noise">
   Differential amplifiers remove common noise
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#referencing">
     Referencing
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#instrumentation-amplifiers">
     Instrumentation amplifiers
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#gain-resistor">
       Gain resistor
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#common-mode-rejection-ratio-cmrr">
     Common mode rejection ratio (CMRR)
    </a>
   </li>
  </ul>
 </li>
</ul>

</nav>
              </div>
              
              <div class="toc-item">
                
              </div>
              
            
          </div>
          

          
          
            
          
          <main class="col-12 col-md-9 col-xl-7 py-md-5 pl-md-5 pr-md-4 bd-content" role="main">
              
              <div>
                
  <section id="amplifiers">
<span id="refamplifierintro"></span><h1>Amplifiers<a class="headerlink" href="#amplifiers" title="Permalink to this headline">#</a></h1>
<p>The operational amplifier is the most simple amplifier circuit. The operational amplifier has two inputs (+ and -), one output, and two power rails (e.g. a 3 and -3V power rail). The output of the amplifier is driven by the power rails, which means it can output a higher voltage than it receives.</p>
<img alt="../../../_images/op-amp.png" class="align-center" src="../../../_images/op-amp.png" />
<p>To get the properties we need for ephys, we use differential or instrumentation amplifiers, which are composed of operational amplifiers in specific configurations. To understand the difference see our Extracellular ephys course materials, days 2 and 3 <a class="reference external" href="https://ahleighton.github.io/eeadec2021/Materials/eeadocsindex.html">here</a>.</p>
<p>In electrophysiology, amplifiers are used to:</p>
<ul class="simple">
<li><p><a class="reference internal" href="#currentdrawn"><span class="std std-ref">Provide the current required to drive the acquisition circuit, preventing this current from being drawn from the electrode</span></a>.</p></li>
<li><p><a class="reference internal" href="#ampsamplify"><span class="std std-ref">Increase the range of the signal to fit the dynamic range of our digitizer</span></a>.</p></li>
<li><p><a class="reference internal" href="#cmmr"><span class="std std-ref">Reject common mode noise</span></a>.</p></li>
</ul>
<section id="amplifier-properties">
<h2>Amplifier properties<a class="headerlink" href="#amplifier-properties" title="Permalink to this headline">#</a></h2>
<section id="amplifiers-have-high-input-impedance">
<h3>Amplifiers have high input impedance<a class="headerlink" href="#amplifiers-have-high-input-impedance" title="Permalink to this headline">#</a></h3>
<p>Amplifier input impedance, Z<sub>a</sub>is very high. The circuit acts as though the current has to cross a very high resistor to actually enter the amplifier. The current flow therefore becomes very low (Ferree et al., 2001), preventing us from drawing much current from the electrode to ground.</p>
</section>
<section id="amplifiers-have-low-output-impedance">
<h3>Amplifiers have low output impedance<a class="headerlink" href="#amplifiers-have-low-output-impedance" title="Permalink to this headline">#</a></h3>
<p>The output impedance of amplifiers is very low, which means that a lot of current can flow <em>from</em> the amplifier. This current enables the driving of the signal through all the subsequent circuits (e.g., interconnect lines, multiplexer, and ADC). Because the output current is provided by a separate power supply, by placing an amplifier in our circuit we make sure that the rest of our recording circuit is driven by current provided by the amplifier, not by current provided by the electrode tip.</p>
</section>
</section>
<section id="amplifiers-in-the-headstage-prevent-current-being-drawn">
<span id="currentdrawn"></span><h2>Amplifiers in the headstage prevent current being drawn<a class="headerlink" href="#amplifiers-in-the-headstage-prevent-current-being-drawn" title="Permalink to this headline">#</a></h2>
<p>A perfect 5V voltage source would always provide exactly 5 volts, no matter what the rest of the circuit looks like. If we put a lot of high impedance components in the rest of the circuit, less current will flow, and if we put low impedance components we will get a high current.</p>
<p>A real voltage source has a bit of output impedance, which means it acts as a voltage source in series with an impedance. This is modelled here (click to open a simulator):</p>
<a class="reference external image-reference" href="https://tinyurl.com/yfvzdxbz"><img alt="../../../_images/eea_fig-83.png" class="align-center" src="../../../_images/eea_fig-83.png" style="width: 852.0px; height: 342.0px;" /></a>
<p>That invisible, small series resistance creates a voltage divider. Though the actual source voltage is the same 5V, the apparent voltage of the source varies depending on the ratio between the output impedance of the source, and the impedance of the rest of the circuit. The lower the impedance of the components used in the rest of the circuit, the higher the relative influence of the source output impedance, and the lower the apparent source voltage (the voltage ‘droops’).</p>
<p>In an ephys acquisition system, the voltage source is the potential changes in the extracellular fluid (<a href="#id1"><span class="problematic" id="id2">|Vec|</span></a>). The resistive and capacitive properties of the electrode create an output resistance. The relative impedance of the circuit before and after <a href="#id3"><span class="problematic" id="id4">|Vin|</span></a> influences the magnitude of the signal at <a href="#id5"><span class="problematic" id="id6">|Vin|</span></a>. If we allow a lot of current to flow from our electrode to ground, we have a low impedance circuit, which will distort our signal. We therefore need something with a very high impedance to stop current being drawn from our <a href="#id7"><span class="problematic" id="id8">|Vec|</span></a>. Amplifiers do exactly this: their high input impedance prevents current flow from the electrodes, and their power supply provides the necessary current for the rest of the circuit from a separate source.</p>
</section>
<section id="differential-amplifiers-remove-common-noise">
<h2>Differential amplifiers remove common noise<a class="headerlink" href="#differential-amplifiers-remove-common-noise" title="Permalink to this headline">#</a></h2>
<section id="referencing">
<h3>Referencing<a class="headerlink" href="#referencing" title="Permalink to this headline">#</a></h3>
<p>We live in an (electrically) very noisy world. To get rid of some of this noise from our recording, we can use a reference, which can be another electrode in the brain or a screw in the animal’s skull. This choice  is very important for the recording: the amplifier will output the difference between the recording electrode and the reference point. That means that the amplifier will do its best to get rid of any signal that the two share. If the recording electrode is picking up 50 Hz noise generated by the mains power supply in the walls, you want the amplifier to get rid of it, so it’s best to use a reference point that will also pick up this noise. However, if the reference is picking up signals that you are interested in, the amplifier will get rid of those too. To choose an appropriate reference, you have to decide what qualifies as noise in your experiment.</p>
</section>
<section id="instrumentation-amplifiers">
<h3>Instrumentation amplifiers<a class="headerlink" href="#instrumentation-amplifiers" title="Permalink to this headline">#</a></h3>
<p>An instrumentation amplifier circuit can compare the signal from a measurement and a reference electrode, and output the difference between the two.
.. raw:: html</p>
<blockquote>
<div><p>&lt;br&gt;
&lt;center&gt;&lt;iframe width=”560” height=”340” src=”<a class="reference external" href="https://www.youtube.com/embed/uPcv0gBjqbA">https://www.youtube.com/embed/uPcv0gBjqbA</a>” title=”YouTube video player” frameborder=”0” allow=”accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture” allowfullscreen&gt;&lt;/iframe&gt;&lt;/center&gt;
&lt;br&gt;</p>
</div></blockquote>
<a class="reference internal image-reference" href="../../../_images/eea_fig-33.png"><img alt="../../../_images/eea_fig-33.png" class="align-center" src="../../../_images/eea_fig-33.png" style="width: 568.0px; height: 227.20000000000002px;" /></a>
<div class="line-block">
<div class="line"><br /></div>
</div>
<p>The instrumentation
|</p>
<a class="reference external image-reference" href="https://tinyurl.com/yjxekrv5"><img alt="../../../_images/eea_fig-53.png" class="align-center" src="../../../_images/eea_fig-53.png" /></a>
<section id="gain-resistor">
<h4>Gain resistor<a class="headerlink" href="#gain-resistor" title="Permalink to this headline">#</a></h4>
<p>The value with which the signal is amplified by the instrumentation amp (the gain) is set by the gain resistor. The voltages on either side of the gain resistor are fixed, because the op-amps are keeping them in place. If we have the same V and lower RGain, current must travel through the resistor, and therefore more current will flow through the feedback resistors of the two buffer op-amps. As those are fixed resistors, we now have a higher I for same R and therefore a higher voltage drop across these resistors. Both buffer op-amps now have to work harder to overcome this voltage drop and will output more extreme voltages. By decreasing the value of RGain, we are basically making the inputs to the final op-amp more different to each other, and therefore increasing the gain of the instrumentation amp.</p>
</section>
</section>
<section id="common-mode-rejection-ratio-cmrr">
<span id="cmmr"></span><h3>Common mode rejection ratio (CMRR)<a class="headerlink" href="#common-mode-rejection-ratio-cmrr" title="Permalink to this headline">#</a></h3>
<p>Common mode noise is signal that is common to both inputs, and thus should be cancelled out by an ideal amplifier. A common way to model how well an amplifier subtracts one input to the other is the following:
We define each input (+ and -) to be a sum of an individual voltage (V1 or V2) plus a voltage common to both. This common voltage (Vc) could be electrical noise or muscle activity we are not interested in and want to discard. In this case, the inputs would be:</p>
<div class="math notranslate nohighlight">
\[V+ = V1 + Vc\]</div>
<div class="math notranslate nohighlight">
\[V- = V2 + Vc\]</div>
<p>(In some examples of a differential amplifier, V2 is ground 0V, which is a perfectly valid value). In an <strong>ideal</strong> differential amplifier, the output should be the difference of both amplified by a factor:</p>
<div class="math notranslate nohighlight">
\[Vout = Ad (V+ - V-)\]</div>
<div class="math notranslate nohighlight">
\[= Ad ((V1+Vc)-(V2+Vc))\]</div>
<div class="math notranslate nohighlight">
\[= Ad (V1-V2)\]</div>
<p>Where Ad is the differential gain, the factor by which the differential signal is amplified.
Here, the unwanted, common signals cancel out and only the signal we are interested in is amplified.</p>
<p>A <strong>real</strong> amplifier, however, acts in a different way. As we’ve seen, small imperfections can lead to part of the common voltages being amplified as well. In this case, the output of a real amplifier ends up being:</p>
<div class="math notranslate nohighlight">
\[Vout = Ad (V1 - V2 ) + Ac * Vc\]</div>
<p>In addition to the differential gain, a new term  ‘Ac’, or common gain, appears. This amplifies the signal common to both inputs. Of course, we want an amplifier to have a differential gain as high as possible and a common gain as low as possible (ideally, Ac would be 0). The relation between these two gains tells us how good an amplifier is at amplifying only the differential signals. This is called the Common Mode Rejection Ratio, or CMRR, simply defined as</p>
<div class="math notranslate nohighlight">
\[CMRR = \frac{Ad}{Ac}\]</div>
<p>or</p>
<div class="math notranslate nohighlight">
\[CMRR = 20log\frac{Ad}{Ac}\]</div>
<p>if measured in decibels.</p>
<p>The higher the CMRR, the better the amplifier is at cancelling out the signals common to both inputs.
Instrumentation amplifiers are not completely immune to common input noise. They are real circuits and, as such, there are multiple ways for these common signals to bleed out into the output. They have, however, a very high CMRR.</p>
</section>
</section>
</section>


              </div>
              
              
              <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="index.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Headstages</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="groundvsreference.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Ground and Reference Pins</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
              
          </main>
          

      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>
<footer class="footer mt-5 mt-md-0">
  <div class="container">
    
    <div class="footer-item">
      <p class="copyright">
    &copy; Copyright 2020-2022, Open Ephys &amp; Contributors.<br>
</p>
    </div>
    
    <div class="footer-item">
      <p class="sphinx-version">
Created using <a href="http://sphinx-doc.org/">Sphinx</a> 4.5.0.<br>
</p>
    </div>
    
  </div>
</footer>
  </body>
</html>